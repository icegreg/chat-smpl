asyncapi: '2.6.0'
info:
  title: ChatApp WebSocket Events API
  version: '1.0.0'
  description: |
    Real-time —Å–æ–±—ã—Ç–∏—è, –¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã–µ –∫–ª–∏–µ–Ω—Ç–∞–º —á–µ—Ä–µ–∑ Centrifugo WebSocket.

    ## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
    ```
    Service ‚Üí RabbitMQ ‚Üí WebSocket Service ‚Üí Centrifugo ‚Üí Client
    ```

    ## –ö–∞–Ω–∞–ª—ã –ø–æ–¥–ø–∏—Å–∫–∏
    - `user:{userId}` - –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    - `chat:{chatId}` - —Å–æ–±—ã—Ç–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–∞—Ç–∞
    - `presence:global` - –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è
  contact:
    name: API Support
  license:
    name: MIT

servers:
  development:
    url: ws://localhost:8888/connection/websocket
    protocol: ws
    description: Development Centrifugo WebSocket endpoint
  production:
    url: wss://your-domain.com/connection/websocket
    protocol: wss
    description: Production Centrifugo WebSocket endpoint

defaultContentType: application/json

channels:
  # ===== CHAT EVENTS =====
  chat.created:
    description: –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π —á–∞—Ç
    subscribe:
      operationId: onChatCreated
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è —Å–æ–∑–¥–∞–Ω–∏—è —á–∞—Ç–∞
      message:
        $ref: '#/components/messages/ChatCreated'

  chat.updated:
    description: –ß–∞—Ç –æ–±–Ω–æ–≤–ª—ë–Ω (–Ω–∞–∑–≤–∞–Ω–∏–µ, –æ–ø–∏—Å–∞–Ω–∏–µ)
    subscribe:
      operationId: onChatUpdated
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–∞—Ç–∞
      message:
        $ref: '#/components/messages/ChatUpdated'

  chat.deleted:
    description: –ß–∞—Ç —É–¥–∞–ª—ë–Ω
    subscribe:
      operationId: onChatDeleted
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è —É–¥–∞–ª–µ–Ω–∏—è —á–∞—Ç–∞
      message:
        $ref: '#/components/messages/ChatDeleted'

  # ===== MESSAGE EVENTS =====
  message.created:
    description: –ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç–µ
    subscribe:
      operationId: onMessageCreated
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
      message:
        $ref: '#/components/messages/MessageCreated'

  message.updated:
    description: –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–æ
    subscribe:
      operationId: onMessageUpdated
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è
      message:
        $ref: '#/components/messages/MessageUpdated'

  message.deleted:
    description: –°–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ (soft delete)
    subscribe:
      operationId: onMessageDeleted
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è —É–¥–∞–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è
      message:
        $ref: '#/components/messages/MessageDeleted'

  message.restored:
    description: –°–æ–æ–±—â–µ–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
    subscribe:
      operationId: onMessageRestored
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è
      message:
        $ref: '#/components/messages/MessageRestored'

  # ===== TYPING EVENTS =====
  typing:
    description: –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞–±–æ—Ä–∞ —Ç–µ–∫—Å—Ç–∞
    subscribe:
      operationId: onTyping
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –Ω–∞–±–æ—Ä–∞ —Ç–µ–∫—Å—Ç–∞
      message:
        $ref: '#/components/messages/Typing'

  # ===== REACTION EVENTS =====
  reaction.added:
    description: –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ
    subscribe:
      operationId: onReactionAdded
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∞–∫—Ü–∏–∏
      message:
        $ref: '#/components/messages/ReactionAdded'

  reaction.removed:
    description: –£–¥–∞–ª–µ–Ω–∞ —Ä–µ–∞–∫—Ü–∏—è —Å —Å–æ–æ–±—â–µ–Ω–∏—è
    subscribe:
      operationId: onReactionRemoved
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è —É–¥–∞–ª–µ–Ω–∏—è —Ä–µ–∞–∫—Ü–∏–∏
      message:
        $ref: '#/components/messages/ReactionRemoved'

  # ===== THREAD EVENTS =====
  thread.created:
    description: –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π —Ç—Ä–µ–¥
    subscribe:
      operationId: onThreadCreated
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç—Ä–µ–¥–∞
      message:
        $ref: '#/components/messages/ThreadCreated'

  thread.archived:
    description: –¢—Ä–µ–¥ –∑–∞–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω
    subscribe:
      operationId: onThreadArchived
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏ —Ç—Ä–µ–¥–∞
      message:
        $ref: '#/components/messages/ThreadArchived'

  # ===== VOICE/CONFERENCE EVENTS =====
  conference.created:
    description: –°–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è
    subscribe:
      operationId: onConferenceCreated
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏
      message:
        $ref: '#/components/messages/ConferenceCreated'

  conference.ended:
    description: –ö–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞
    subscribe:
      operationId: onConferenceEnded
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏
      message:
        $ref: '#/components/messages/ConferenceEnded'

  conference.scheduled:
    description: –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–æ–≤–∞—è –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è
    subscribe:
      operationId: onConferenceScheduled
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏
      message:
        $ref: '#/components/messages/ConferenceScheduled'

  conference.cancelled:
    description: –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞
    subscribe:
      operationId: onConferenceCancelled
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –æ—Ç–º–µ–Ω—ã –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏
      message:
        $ref: '#/components/messages/ConferenceCancelled'

  conference.rsvp_updated:
    description: –û–±–Ω–æ–≤–ª—ë–Ω RSVP —Å—Ç–∞—Ç—É—Å —É—á–∞—Å—Ç–Ω–∏–∫–∞
    subscribe:
      operationId: onRSVPUpdated
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è RSVP
      message:
        $ref: '#/components/messages/RSVPUpdated'

  conference.reminder:
    description: –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –ø—Ä–µ–¥—Å—Ç–æ—è—â–µ–π –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏
    subscribe:
      operationId: onConferenceReminder
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏
      message:
        $ref: '#/components/messages/ConferenceReminder'

  # ===== PARTICIPANT EVENTS =====
  participant.joined:
    description: –£—á–∞—Å—Ç–Ω–∏–∫ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏
    subscribe:
      operationId: onParticipantJoined
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∞
      message:
        $ref: '#/components/messages/ParticipantJoined'

  participant.left:
    description: –£—á–∞—Å—Ç–Ω–∏–∫ –ø–æ–∫–∏–Ω—É–ª –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—é
    subscribe:
      operationId: onParticipantLeft
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –≤—ã—Ö–æ–¥–∞ —É—á–∞—Å—Ç–Ω–∏–∫–∞
      message:
        $ref: '#/components/messages/ParticipantLeft'

  participant.muted:
    description: –ò–∑–º–µ–Ω—ë–Ω —Å—Ç–∞—Ç—É—Å mute —É—á–∞—Å—Ç–Ω–∏–∫–∞
    subscribe:
      operationId: onParticipantMuted
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è mute/unmute —É—á–∞—Å—Ç–Ω–∏–∫–∞
      message:
        $ref: '#/components/messages/ParticipantMuted'

  participant.speaking:
    description: –£—á–∞—Å—Ç–Ω–∏–∫ –Ω–∞—á–∞–ª/–ø—Ä–µ–∫—Ä–∞—Ç–∏–ª –≥–æ–≤–æ—Ä–∏—Ç—å
    subscribe:
      operationId: onParticipantSpeaking
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –≥–æ–≤–æ—Ä–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∞
      message:
        $ref: '#/components/messages/ParticipantSpeaking'

  participant.role_changed:
    description: –ò–∑–º–µ–Ω–µ–Ω–∞ —Ä–æ–ª—å —É—á–∞—Å—Ç–Ω–∏–∫–∞ –≤ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏
    subscribe:
      operationId: onParticipantRoleChanged
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–æ–ª–∏
      message:
        $ref: '#/components/messages/ParticipantRoleChanged'

  participant.added:
    description: –£—á–∞—Å—Ç–Ω–∏–∫ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—é
    subscribe:
      operationId: onParticipantAdded
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∞
      message:
        $ref: '#/components/messages/ParticipantAdded'

  participant.removed:
    description: –£—á–∞—Å—Ç–Ω–∏–∫ —É–¥–∞–ª—ë–Ω –∏–∑ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏
    subscribe:
      operationId: onParticipantRemoved
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è —É–¥–∞–ª–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∞
      message:
        $ref: '#/components/messages/ParticipantRemoved'

  # ===== CALL EVENTS =====
  call.initiated:
    description: –ò–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω –∑–≤–æ–Ω–æ–∫
    subscribe:
      operationId: onCallInitiated
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –≤—Ö–æ–¥—è—â–µ–≥–æ –∑–≤–æ–Ω–∫–∞
      message:
        $ref: '#/components/messages/CallInitiated'

  call.answered:
    description: –ó–≤–æ–Ω–æ–∫ –ø—Ä–∏–Ω—è—Ç
    subscribe:
      operationId: onCallAnswered
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –ø—Ä–∏–Ω—è—Ç–∏—è –∑–≤–æ–Ω–∫–∞
      message:
        $ref: '#/components/messages/CallAnswered'

  call.ended:
    description: –ó–≤–æ–Ω–æ–∫ –∑–∞–≤–µ—Ä—à—ë–Ω
    subscribe:
      operationId: onCallEnded
      summary: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–≤–æ–Ω–∫–∞
      message:
        $ref: '#/components/messages/CallEnded'

components:
  messages:
    # ===== CHAT MESSAGES =====
    ChatCreated:
      name: ChatCreated
      title: –ß–∞—Ç —Å–æ–∑–¥–∞–Ω
      summary: –°–æ–±—ã—Ç–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —á–∞—Ç–∞
      contentType: application/json
      payload:
        $ref: '#/components/schemas/ChatEvent'

    ChatUpdated:
      name: ChatUpdated
      title: –ß–∞—Ç –æ–±–Ω–æ–≤–ª—ë–Ω
      summary: –°–æ–±—ã—Ç–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–∞—Ç–∞
      contentType: application/json
      payload:
        $ref: '#/components/schemas/ChatEvent'

    ChatDeleted:
      name: ChatDeleted
      title: –ß–∞—Ç —É–¥–∞–ª—ë–Ω
      summary: –°–æ–±—ã—Ç–∏–µ —É–¥–∞–ª–µ–Ω–∏—è —á–∞—Ç–∞
      contentType: application/json
      payload:
        $ref: '#/components/schemas/ChatDeletedEvent'

    # ===== MESSAGE MESSAGES =====
    MessageCreated:
      name: MessageCreated
      title: –°–æ–æ–±—â–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ
      summary: –°–æ–±—ã—Ç–∏–µ –Ω–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
      contentType: application/json
      payload:
        $ref: '#/components/schemas/MessageEvent'
      examples:
        - name: TextMessage
          summary: –¢–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
          payload:
            type: message.created
            timestamp: '2024-01-15T10:30:00Z'
            actor_id: '550e8400-e29b-41d4-a716-446655440000'
            chat_id: '660e8400-e29b-41d4-a716-446655440001'
            participants:
              - '550e8400-e29b-41d4-a716-446655440000'
              - '550e8400-e29b-41d4-a716-446655440001'
            data:
              id: '770e8400-e29b-41d4-a716-446655440002'
              chat_id: '660e8400-e29b-41d4-a716-446655440001'
              sender_id: '550e8400-e29b-41d4-a716-446655440000'
              content: '–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?'
              sent_at: '2024-01-15T10:30:00Z'
              sender_username: 'john_doe'
              sender_display_name: 'John Doe'

    MessageUpdated:
      name: MessageUpdated
      title: –°–æ–æ–±—â–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ
      summary: –°–æ–±—ã—Ç–∏–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è
      contentType: application/json
      payload:
        $ref: '#/components/schemas/MessageEvent'

    MessageDeleted:
      name: MessageDeleted
      title: –°–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ
      summary: –°–æ–±—ã—Ç–∏–µ —É–¥–∞–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è
      contentType: application/json
      payload:
        $ref: '#/components/schemas/MessageDeletedEvent'

    MessageRestored:
      name: MessageRestored
      title: –°–æ–æ–±—â–µ–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
      summary: –°–æ–±—ã—Ç–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è
      contentType: application/json
      payload:
        $ref: '#/components/schemas/MessageRestoredEvent'

    # ===== TYPING =====
    Typing:
      name: Typing
      title: –ù–∞–±–æ—Ä —Ç–µ–∫—Å—Ç–∞
      summary: –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞–±–æ—Ä–∞ —Ç–µ–∫—Å—Ç–∞
      contentType: application/json
      payload:
        $ref: '#/components/schemas/TypingEvent'

    # ===== REACTIONS =====
    ReactionAdded:
      name: ReactionAdded
      title: –†–µ–∞–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞
      summary: –°–æ–±—ã—Ç–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∞–∫—Ü–∏–∏
      contentType: application/json
      payload:
        $ref: '#/components/schemas/ReactionEvent'

    ReactionRemoved:
      name: ReactionRemoved
      title: –†–µ–∞–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∞
      summary: –°–æ–±—ã—Ç–∏–µ —É–¥–∞–ª–µ–Ω–∏—è —Ä–µ–∞–∫—Ü–∏–∏
      contentType: application/json
      payload:
        $ref: '#/components/schemas/ReactionEvent'

    # ===== THREADS =====
    ThreadCreated:
      name: ThreadCreated
      title: –¢—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω
      summary: –°–æ–±—ã—Ç–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ç—Ä–µ–¥–∞
      contentType: application/json
      payload:
        $ref: '#/components/schemas/ThreadEvent'

    ThreadArchived:
      name: ThreadArchived
      title: –¢—Ä–µ–¥ –∑–∞–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω
      summary: –°–æ–±—ã—Ç–∏–µ –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏ —Ç—Ä–µ–¥–∞
      contentType: application/json
      payload:
        $ref: '#/components/schemas/ThreadEvent'

    # ===== CONFERENCE =====
    ConferenceCreated:
      name: ConferenceCreated
      title: –ö–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
      summary: –°–æ–±—ã—Ç–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏
      contentType: application/json
      payload:
        $ref: '#/components/schemas/ConferenceEvent'

    ConferenceEnded:
      name: ConferenceEnded
      title: –ö–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞
      summary: –°–æ–±—ã—Ç–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏
      contentType: application/json
      payload:
        $ref: '#/components/schemas/ConferenceEvent'

    ConferenceScheduled:
      name: ConferenceScheduled
      title: –ö–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞
      summary: –°–æ–±—ã—Ç–∏–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏
      contentType: application/json
      payload:
        $ref: '#/components/schemas/ScheduledConferenceEvent'

    ConferenceCancelled:
      name: ConferenceCancelled
      title: –ö–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞
      summary: –°–æ–±—ã—Ç–∏–µ –æ—Ç–º–µ–Ω—ã –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏
      contentType: application/json
      payload:
        $ref: '#/components/schemas/ScheduledConferenceEvent'

    RSVPUpdated:
      name: RSVPUpdated
      title: RSVP –æ–±–Ω–æ–≤–ª—ë–Ω
      summary: –°–æ–±—ã—Ç–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è RSVP —Å—Ç–∞—Ç—É—Å–∞
      contentType: application/json
      payload:
        $ref: '#/components/schemas/RSVPUpdatedEvent'

    ConferenceReminder:
      name: ConferenceReminder
      title: –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏
      summary: –°–æ–±—ã—Ç–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –ø—Ä–µ–¥—Å—Ç–æ—è—â–µ–π –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏
      contentType: application/json
      payload:
        $ref: '#/components/schemas/ConferenceReminderEvent'

    # ===== PARTICIPANTS =====
    ParticipantJoined:
      name: ParticipantJoined
      title: –£—á–∞—Å—Ç–Ω–∏–∫ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è
      summary: –°–æ–±—ã—Ç–∏–µ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∞
      contentType: application/json
      payload:
        $ref: '#/components/schemas/ParticipantEvent'

    ParticipantLeft:
      name: ParticipantLeft
      title: –£—á–∞—Å—Ç–Ω–∏–∫ –≤—ã—à–µ–ª
      summary: –°–æ–±—ã—Ç–∏–µ –≤—ã—Ö–æ–¥–∞ —É—á–∞—Å—Ç–Ω–∏–∫–∞
      contentType: application/json
      payload:
        $ref: '#/components/schemas/ParticipantEvent'

    ParticipantMuted:
      name: ParticipantMuted
      title: –£—á–∞—Å—Ç–Ω–∏–∫ muted
      summary: –°–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è mute —Å—Ç–∞—Ç—É—Å–∞
      contentType: application/json
      payload:
        $ref: '#/components/schemas/ParticipantEvent'

    ParticipantSpeaking:
      name: ParticipantSpeaking
      title: –£—á–∞—Å—Ç–Ω–∏–∫ –≥–æ–≤–æ—Ä–∏—Ç
      summary: –°–æ–±—ã—Ç–∏–µ –≥–æ–≤–æ—Ä–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∞
      contentType: application/json
      payload:
        $ref: '#/components/schemas/SpeakingEvent'

    ParticipantRoleChanged:
      name: ParticipantRoleChanged
      title: –†–æ–ª—å —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∞
      summary: –°–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–æ–ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞
      contentType: application/json
      payload:
        $ref: '#/components/schemas/ParticipantRoleChangedEvent'

    ParticipantAdded:
      name: ParticipantAdded
      title: –£—á–∞—Å—Ç–Ω–∏–∫ –¥–æ–±–∞–≤–ª–µ–Ω
      summary: –°–æ–±—ã—Ç–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∞
      contentType: application/json
      payload:
        $ref: '#/components/schemas/ParticipantEvent'

    ParticipantRemoved:
      name: ParticipantRemoved
      title: –£—á–∞—Å—Ç–Ω–∏–∫ —É–¥–∞–ª—ë–Ω
      summary: –°–æ–±—ã—Ç–∏–µ —É–¥–∞–ª–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∞
      contentType: application/json
      payload:
        $ref: '#/components/schemas/ParticipantRemovedEvent'

    # ===== CALLS =====
    CallInitiated:
      name: CallInitiated
      title: –ó–≤–æ–Ω–æ–∫ –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω
      summary: –°–æ–±—ã—Ç–∏–µ –≤—Ö–æ–¥—è—â–µ–≥–æ –∑–≤–æ–Ω–∫–∞
      contentType: application/json
      payload:
        $ref: '#/components/schemas/CallEvent'

    CallAnswered:
      name: CallAnswered
      title: –ó–≤–æ–Ω–æ–∫ –ø—Ä–∏–Ω—è—Ç
      summary: –°–æ–±—ã—Ç–∏–µ –ø—Ä–∏–Ω—è—Ç–∏—è –∑–≤–æ–Ω–∫–∞
      contentType: application/json
      payload:
        $ref: '#/components/schemas/CallEvent'

    CallEnded:
      name: CallEnded
      title: –ó–≤–æ–Ω–æ–∫ –∑–∞–≤–µ—Ä—à—ë–Ω
      summary: –°–æ–±—ã—Ç–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–≤–æ–Ω–∫–∞
      contentType: application/json
      payload:
        $ref: '#/components/schemas/CallEvent'

  schemas:
    # ===== BASE EVENT WRAPPER =====
    BaseEvent:
      type: object
      description: –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–±—ã—Ç–∏—è
      required:
        - type
        - timestamp
        - actor_id
        - chat_id
        - participants
        - data
      properties:
        type:
          type: string
          description: –¢–∏–ø —Å–æ–±—ã—Ç–∏—è
          example: message.created
        timestamp:
          type: string
          format: date-time
          description: –í—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è (RFC3339)
          example: '2024-01-15T10:30:00Z'
        actor_id:
          type: string
          format: uuid
          description: ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–≤—à–µ–≥–æ —Å–æ–±—ã—Ç–∏–µ
          example: '550e8400-e29b-41d4-a716-446655440000'
        chat_id:
          type: string
          format: uuid
          description: ID —á–∞—Ç–∞
          example: '660e8400-e29b-41d4-a716-446655440001'
        participants:
          type: array
          items:
            type: string
            format: uuid
          description: –°–ø–∏—Å–æ–∫ ID —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–º –¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–±—ã—Ç–∏–µ
        data:
          type: object
          description: Payload —Å–æ–±—ã—Ç–∏—è (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∏–ø–∞)

    # ===== CHAT SCHEMAS =====
    ChatData:
      type: object
      description: –î–∞–Ω–Ω—ã–µ —á–∞—Ç–∞
      required:
        - id
        - name
        - chat_type
        - created_by
      properties:
        id:
          type: string
          format: uuid
          description: ID —á–∞—Ç–∞
        name:
          type: string
          description: –ù–∞–∑–≤–∞–Ω–∏–µ —á–∞—Ç–∞
        chat_type:
          type: string
          enum: [direct, group, channel]
          description: –¢–∏–ø —á–∞—Ç–∞
        created_by:
          type: string
          format: uuid
          description: ID —Å–æ–∑–¥–∞—Ç–µ–ª—è —á–∞—Ç–∞

    ChatEvent:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/ChatData'

    ChatDeletedEvent:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            data:
              type: object
              properties:
                chat_id:
                  type: string
                  format: uuid

    # ===== MESSAGE SCHEMAS =====
    MessageData:
      type: object
      description: –î–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
      required:
        - id
        - chat_id
        - sender_id
        - content
        - sent_at
      properties:
        id:
          type: string
          format: uuid
          description: ID —Å–æ–æ–±—â–µ–Ω–∏—è
        chat_id:
          type: string
          format: uuid
          description: ID —á–∞—Ç–∞
        sender_id:
          type: string
          format: uuid
          description: ID –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
        content:
          type: string
          description: –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
        sent_at:
          type: string
          format: date-time
          description: –í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏
        updated_at:
          type: string
          format: date-time
          description: –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        parent_id:
          type: string
          format: uuid
          description: ID —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (–¥–ª—è reply)
        sender_username:
          type: string
          description: Username –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
        sender_display_name:
          type: string
          description: Display name –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
        sender_avatar_url:
          type: string
          format: uri
          description: URL –∞–≤–∞—Ç–∞—Ä–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
        file_link_ids:
          type: array
          items:
            type: string
            format: uuid
          description: IDs –ø—Ä–∏–∫—Ä–µ–ø–ª—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

    MessageEvent:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/MessageData'

    MessageDeletedData:
      type: object
      required:
        - message_id
        - chat_id
        - is_moderated_deletion
      properties:
        message_id:
          type: string
          format: uuid
        chat_id:
          type: string
          format: uuid
        is_moderated_deletion:
          type: boolean
          description: True –µ—Å–ª–∏ —É–¥–∞–ª–µ–Ω–æ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–º

    MessageDeletedEvent:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/MessageDeletedData'

    MessageRestoredData:
      type: object
      required:
        - message_id
        - chat_id
        - sender_id
        - content
      properties:
        message_id:
          type: string
          format: uuid
        chat_id:
          type: string
          format: uuid
        sender_id:
          type: string
          format: uuid
        content:
          type: string

    MessageRestoredEvent:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/MessageRestoredData'

    # ===== TYPING SCHEMA =====
    TypingData:
      type: object
      required:
        - user_id
        - is_typing
      properties:
        user_id:
          type: string
          format: uuid
          description: ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—á–∞—Ç–∞–µ—Ç
        is_typing:
          type: boolean
          description: True –µ—Å–ª–∏ –ø–µ—á–∞—Ç–∞–µ—Ç, false –µ—Å–ª–∏ –ø—Ä–µ–∫—Ä–∞—Ç–∏–ª

    TypingEvent:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/TypingData'

    # ===== REACTION SCHEMA =====
    ReactionData:
      type: object
      required:
        - message_id
        - emoji
        - user_id
      properties:
        message_id:
          type: string
          format: uuid
        emoji:
          type: string
          description: Emoji —Ä–µ–∞–∫—Ü–∏–∏
          example: 'üëç'
        user_id:
          type: string
          format: uuid

    ReactionEvent:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/ReactionData'

    # ===== THREAD SCHEMA =====
    ThreadData:
      type: object
      required:
        - id
        - chat_id
        - thread_type
        - message_count
        - is_archived
        - restricted_participants
      properties:
        id:
          type: string
          format: uuid
        chat_id:
          type: string
          format: uuid
        parent_message_id:
          type: string
          format: uuid
        thread_type:
          type: string
          enum: [user, system, conference]
        title:
          type: string
        message_count:
          type: integer
        created_by:
          type: string
          format: uuid
        is_archived:
          type: boolean
        restricted_participants:
          type: boolean

    ThreadEvent:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            data:
              $ref: '#/components/schemas/ThreadData'

    # ===== CONFERENCE SCHEMAS =====
    ConferenceData:
      type: object
      required:
        - id
        - name
        - created_by
        - status
        - max_members
        - participant_count
        - created_at
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        chat_id:
          type: string
          format: uuid
        created_by:
          type: string
          format: uuid
        status:
          type: string
          enum: [active, ended]
        max_members:
          type: integer
        participant_count:
          type: integer
        started_at:
          type: string
          format: date-time
        ended_at:
          type: string
          format: date-time
        created_at:
          type: string
          format: date-time

    ConferenceEvent:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        chat_id:
          type: string
          format: uuid
        created_by:
          type: string
          format: uuid
        status:
          type: string
          enum: [active, ended]
        max_members:
          type: integer
        participant_count:
          type: integer
        started_at:
          type: string
          format: date-time
        ended_at:
          type: string
          format: date-time
        created_at:
          type: string
          format: date-time

    ScheduledConferenceEvent:
      allOf:
        - $ref: '#/components/schemas/ConferenceEvent'
        - type: object
          properties:
            event_type:
              type: string
              enum: [adhoc, adhoc_chat, scheduled, recurring]
            scheduled_at:
              type: string
              format: date-time
            series_id:
              type: string
              format: uuid
            accepted_count:
              type: integer
            declined_count:
              type: integer

    RSVPUpdatedEvent:
      type: object
      required:
        - conference_id
        - user_id
        - rsvp_status
      properties:
        conference_id:
          type: string
          format: uuid
        user_id:
          type: string
          format: uuid
        rsvp_status:
          type: string
          enum: [pending, accepted, declined]

    ConferenceReminderEvent:
      type: object
      required:
        - conference_id
        - user_id
        - conference_name
        - scheduled_at
        - minutes_before
      properties:
        conference_id:
          type: string
          format: uuid
        user_id:
          type: string
          format: uuid
        conference_name:
          type: string
        scheduled_at:
          type: string
          format: date-time
        minutes_before:
          type: integer
          description: –ó–∞ —Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç –¥–æ –Ω–∞—á–∞–ª–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ

    # ===== PARTICIPANT SCHEMAS =====
    ParticipantData:
      type: object
      required:
        - id
        - conference_id
        - user_id
        - status
        - is_muted
        - is_deaf
        - is_speaking
      properties:
        id:
          type: string
          format: uuid
        conference_id:
          type: string
          format: uuid
        chat_id:
          type: string
          format: uuid
        user_id:
          type: string
          format: uuid
        status:
          type: string
          enum: [connecting, joined, left, kicked]
        is_muted:
          type: boolean
        is_deaf:
          type: boolean
        is_speaking:
          type: boolean
        username:
          type: string
        display_name:
          type: string
        avatar_url:
          type: string
          format: uri
        joined_at:
          type: string
          format: date-time
        left_at:
          type: string
          format: date-time

    ParticipantEvent:
      $ref: '#/components/schemas/ParticipantData'

    SpeakingEvent:
      type: object
      required:
        - participant_id
        - is_speaking
      properties:
        participant_id:
          type: string
          format: uuid
        is_speaking:
          type: boolean

    ParticipantRoleChangedEvent:
      type: object
      required:
        - conference_id
        - user_id
        - old_role
        - new_role
      properties:
        conference_id:
          type: string
          format: uuid
        user_id:
          type: string
          format: uuid
        old_role:
          type: string
          enum: [originator, moderator, speaker, assistant, participant]
        new_role:
          type: string
          enum: [originator, moderator, speaker, assistant, participant]

    ParticipantRemovedEvent:
      type: object
      required:
        - conference_id
        - user_id
      properties:
        conference_id:
          type: string
          format: uuid
        user_id:
          type: string
          format: uuid

    # ===== CALL SCHEMAS =====
    CallData:
      type: object
      required:
        - id
        - caller_id
        - callee_id
        - status
        - duration
      properties:
        id:
          type: string
          format: uuid
        caller_id:
          type: string
          format: uuid
        callee_id:
          type: string
          format: uuid
        chat_id:
          type: string
          format: uuid
        conference_id:
          type: string
          format: uuid
        status:
          type: string
          enum: [initiated, ringing, answered, ended, missed, failed]
        duration:
          type: integer
          description: –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
        end_reason:
          type: string
        caller_username:
          type: string
        caller_display_name:
          type: string
        callee_username:
          type: string
        callee_display_name:
          type: string
        started_at:
          type: string
          format: date-time
        answered_at:
          type: string
          format: date-time
        ended_at:
          type: string
          format: date-time

    CallEvent:
      $ref: '#/components/schemas/CallData'

tags:
  - name: chat
    description: –°–æ–±—ã—Ç–∏—è —á–∞—Ç–æ–≤
  - name: message
    description: –°–æ–±—ã—Ç–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
  - name: typing
    description: –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –Ω–∞–±–æ—Ä–∞ —Ç–µ–∫—Å—Ç–∞
  - name: reaction
    description: –†–µ–∞–∫—Ü–∏–∏ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
  - name: thread
    description: –°–æ–±—ã—Ç–∏—è —Ç—Ä–µ–¥–æ–≤
  - name: conference
    description: –°–æ–±—ã—Ç–∏—è –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–π
  - name: participant
    description: –°–æ–±—ã—Ç–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–π
  - name: call
    description: –°–æ–±—ã—Ç–∏—è –∑–≤–æ–Ω–∫–æ–≤
